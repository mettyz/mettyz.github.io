<!doctype html>
<html>

<head>

  <title>
    
      Paper Reading Record 2 | MettyZ's Blog
    
  </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <link rel="shortcut icon" type="image/png" href="favicon.png">
  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="/feed.xml" title="MettyZ's Blog" />
  <!-- Use RSS-2.0 -->
  <!--<link href="/rss-feed.xml" type="application/rss+xml" rel="alternate" title="MettyZ's Blog | "/>
  //-->

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quattrocento+Sans">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
  
	<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
     TeX: {
         equationNumbers: {
             autoNumber: "AMS"
         }
     },
     tex2jax: {
         inlineMath: [ ['$','$'] ],
         displayMath: [ ['$$','$$'] ],
         processEscapes: true,
     }
 });
 </script>
 <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
 </script>
  
  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>


  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Paper Reading Record 2 | MettyZ’s Blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Paper Reading Record 2" />
<meta name="author" content="mettyz" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Human Motion Prediction, 3D-skeleton, Quaternion, RNN…" />
<meta property="og:description" content="Human Motion Prediction, 3D-skeleton, Quaternion, RNN…" />
<meta property="og:site_name" content="MettyZ’s Blog" />
<meta property="og:image" content="/PR2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-06T00:00:00+08:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/PR2.html"},"author":{"@type":"Person","name":"mettyz"},"url":"/PR2.html","headline":"Paper Reading Record 2","dateModified":"2020-08-06T00:00:00+08:00","datePublished":"2020-08-06T00:00:00+08:00","description":"Human Motion Prediction, 3D-skeleton, Quaternion, RNN…","image":"/PR2.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


<body>

  <div class="container">
    <header class="masthead">
  <h3 class="masthead-title">
    <a href="/">MettyZ's Blog</a>
    <small class="masthead-subtitle"></small>
    <div class="menu">
  <nav class="menu-content">
    
      <a href="/menu/about.html">About</a>
    
      <a href="/menu/writing.html">Writing</a>
    
      <a href="/menu/contact.html">Contact</a>
    
  </nav>
  <nav class="social-icons">
    
  
  
    <a href="https://www.github.com/mettyz" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:1243049625@qq.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

  
  
    <a href="/feed.xml"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  

  </nav>
</div>

  </h3>
</header>


    <div class="post-container">
      <h1>
  Paper Reading Record 2
</h1>


  <img src="/assets/img/PR2.png">


<p>QuaterNet: A Quaternion-based Recurrent Model for Human Motion <a href="https://arxiv.org/pdf/1805.06485.pdf">[Paper]</a></p>

<!--more-->

<blockquote>
  <p>写在前面：文中包含个人理解，不保证正确，如理解有误，欢迎指正。</p>
</blockquote>

<h2 id="main-idea">Main Idea</h2>

<ul>
  <li>
    <p>基于<strong>四元数</strong>构建模型，在描述3D运动上有天然优势</p>
  </li>
  <li>
    <p>损失函数<strong>采用关节点位置误差</strong>（将 预测旋转 与 预测绝对位置 两类方法的优势相结合）</p>
  </li>
  <li>
    <p>为短期预测与长期预测分别构建了模型</p>

    <blockquote>
      <p>对长期预测，加入了人工特征控制（轨迹、速度、面部朝向、步频）</p>
    </blockquote>
  </li>
  <li>
    <p><strong>残差连接</strong>在短期预测中有优势，在长期预测中不适用</p>
  </li>
</ul>

<h2 id="introduction">Introduction</h2>

<ul>
  <li>
    <p>人类行为是一个具有<strong>高度内在不确定性</strong>的随机序列过程，这为长期预测带来挑战</p>

    <p><br /></p>
  </li>
  <li>
    <p><strong>短期预测</strong>通常被看作<em>预测</em> 任务 (short-term prediction)</p>

    <blockquote>
      <p>能够通过将预测结果与参考结果对比来定量计算损失</p>
    </blockquote>

    <p><br /></p>
  </li>
  <li>
    <p><strong>长期预测</strong>通常被看作<em>生成</em> 任务 (long-term generation)</p>

    <blockquote>
      <p>定量评估较为困难，可以让人来评估生成质量</p>
    </blockquote>
  </li>
</ul>

<h2 id="related-work">Related Work</h2>

<ul>
  <li>
    <p><strong>行为预测的两大类方式 —— <em>Joint Rotations</em> v.s. <em>Joint Positions</em></strong></p>

    <ul>
      <li>
        <p><strong>预测关节点的旋转 (Joint Rotations)</strong></p>

        <p>优势：自然地以骨架作为约束，避免了躯干伸缩及超出关节范围的运动等问题</p>

        <p>缺陷：</p>

        <ul>
          <li>
            <p>通常计算各关节点的平均损失，即不同关节点的权重相同</p>

            <blockquote>
              <p>实际上，不同关节点的错位对姿态的影响程度不同，如连接躯干及四肢的关节点对姿态的影响强于四肢末端的关节点</p>
            </blockquote>

            <p>这可能导致模型的预测结果在重要关节上出现较大误差，影响视觉效果</p>

            <p><br /></p>
          </li>
        </ul>
      </li>
      <li>
        <p><strong>预测关节点的位置 (Joint Positions)</strong></p>

        <p>优势：极小化绝对位置损失，避免了上述缺陷</p>

        <p>缺陷：缺乏骨架约束，四肢躯干可能出现变形，需要将预测结果作重映射调整，增加训练难度，带来额外开销，且重映射可能导致动作的不连续</p>

        <p><br /></p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>利用残差连接帮助训练</strong></p>

    <ul>
      <li>
        <p>直观上理解，残差连接迫使网络预测变化的 “速度 (velocities) “ 而不是 “值 (absolute values)”</p>

        <p><img src="../assets/img/2020-08-06-PR2_pic/image-20200806175039090.png" alt="image-20200806175039090" style="zoom: 67%;" /></p>

        <blockquote>
          <p>[1] Julieta Martinez, Michael J. Black, and Javier Romero. On human motion prediction using recurrent neural networks. In Conference on Vision and Pattern Recognition (CVPR), 2017.</p>
        </blockquote>

        <ul>
          <li>
            <p>优势：使得需要预测的值被限制在较小的范围内，有助于网络收敛</p>

            <p>缺陷：在长期预测任务上表现不稳定，由于误差累积可能导致糟糕结果</p>

            <p><br /></p>
          </li>
        </ul>
      </li>
      <li>
        <p><strong>建模方法</strong></p>

        <ul>
          <li>
            <p>早期方法：每步输入ground truth motion作为教师监督</p>

            <p>缺陷：模型不具备错误恢复能力</p>
          </li>
          <li>
            <p>[1] 方法：每步输入上一步的预测结果</p>

            <p>缺陷：如果用于长期预测，累积损失将会很大，导致模型将难以训练</p>
          </li>
          <li>
            <p>任务分解法：将长期预测任务分解为 1) 定义运动轨迹 2) 用 footsteps 标注轨迹 3) 生成姿态序列</p>
          </li>
          <li>
            <p>生成模型</p>

            <blockquote>
              <p>Jacob Walker, Kenneth Marino, Abhinav Gupta, and Martial Hebert. The pose knows: Video forecasting by generating pose futures. International Conference on Computer Vision (ICCV), 2017. 【待阅读】</p>
            </blockquote>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="method">Method</h2>

<h3 id="architecture">Architecture</h3>

<p><img src="../assets/img/2020-08-06-PR2_pic/image-20200806193719030.png" alt="image-20200806193719030" style="zoom:80%;" /></p>

<p><br /></p>

<ul>
  <li>
    <p>构建使用双层GRU的自回归模型</p>

    <blockquote>
      <p>与 [1] 不同，团队发现增加第二层GRU具有经验优势，但不必增加到三层【可以验证一下】，设置 hidden size = 1000</p>
    </blockquote>

    <p><br /></p>
  </li>
  <li>
    <p>Short-term Prediction：每步输入上一步的预测结果</p>

    <p>Long-term Generation：每步以概率 p 输入 ground truth 监督</p>

    <blockquote>
      <p>随着训练过程的进行，p 从1开始递减： $p_{t+1} = \beta p_t$，其中 $\beta =0.995$</p>
    </blockquote>

    <p><br /></p>
  </li>
  <li>
    <p>Rotations：由单位四元数描述的关节旋转状态</p>

    <p>Translations：用于建模高频运动细节，使生成的动画更加逼真</p>

    <p>Controls：轨迹控制信息</p>

    <blockquote>
      <p>Translations 和 Controls 的数学细节没太看懂</p>
    </blockquote>

    <p><br /></p>
  </li>
  <li>
    <p>对短期预测采用了QMul，即训练模型预测从当前姿态到下一姿态的变换角度</p>

    <p>对长期预测未采用QMul，即训练模型预测准确的下一姿态</p>

    <blockquote>
      <p>如下图实验显示，残差连接用于长期预测将累积误差，导致模型不稳定，</p>

      <p>而不采用残差的方法在长期预测中表现出优势</p>
    </blockquote>

    <p><img src="../assets/img/2020-08-06-PR2_pic/image-20200806234435170.png" alt="image-20200806234435170" style="zoom:67%;" /></p>
  </li>
</ul>

<h3 id="rotation-parameterization">Rotation Parameterization</h3>

<ul>
  <li>
    <p><strong>欧拉角，指数映射</strong>  $ R^3$</p>

    <p>缺陷：表示不唯一 ($\alpha=\alpha+2\pi n$)、表示空间不连续、奇点 (gimbal loack 万向锁)</p>
  </li>
  <li>
    <p><strong>四元数</strong>  $ R^4 $</p>

    <p>优势：不存在上述三维空间中的问题，且数值更加稳定、计算更加高效</p>

    <p>缺陷：需要保证单位长度，因此每步都需要进行正则化</p>

    <blockquote>
      <p>对 $q=w+xi+yj+zk$，要求 $||q||=\sqrt{w^2+x^2+y^2+z^2}=1$</p>

      <p>本文为损失函数添加了正则约束 $\lambda(w^2+x^2+y^2+z^2-1)$ ，设置 $\lambda=0.01$</p>
    </blockquote>
  </li>
</ul>

<h3 id="forward-kinematics-loss">Forward Kinematics Loss</h3>

<ul>
  <li>
    <p>直接对角度进行回归可能会导致关键关节点出现偏差，进而显著影响整体姿态效果</p>
  </li>
  <li>
    <p>本文的损失函数根据预测出的四元数计算出关节点的预测位置，再计算欧几里得距离作为损失</p>

    <blockquote>
      <p><strong>Forward kinematics</strong> refers to the use of the kinematic equations of a robot to compute the position of the end-effector from specified values for the joint parameters. <a href="https://en.wikipedia.org/wiki/Forward_kinematics">Wiki</a></p>
    </blockquote>
  </li>
</ul>

<h3 id="long-term-generation">Long-Term Generation</h3>

<ul>
  <li>
    <p>任务定义：给定平均速度与运动轨迹，生成姿态序列</p>
  </li>
  <li>
    <p>任务分解</p>

    <ul>
      <li>
        <p>1）沿着轨迹定义参数：角色面对的方向，局部速度，脚步频率</p>

        <blockquote>
          <p><strong>轨迹表示</strong></p>

          <p>可视为分段线性样条 piecewise linear spline，可理解为分段线性函数</p>

          <p>在本任务背景下，轨迹可以按等长时间分段，相当于在每小段时间内面向某个方向，以某个速度前进</p>
        </blockquote>

        <blockquote>
          <p><strong>pace network</strong></p>

          <p>参数可以人工设置，也可以通过训练速度网络(pace network)自动生成</p>

          <p>采用单层GRU, hidden size = 30，输入轨迹曲线与上一步的隐状态，预测上述参数</p>

          <p>可以根据 在线/离线场景 设置 单向/双向GRU</p>
        </blockquote>
      </li>
      <li>
        <p>2）预测姿态序列 (pose network，如架构图所示)</p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="experiments">Experiments</h2>

<blockquote>
  <p>下述只提及文中部分实验结果</p>
</blockquote>

<ul>
  <li>
    <p>证实残差连接在短期预测中的优势</p>

    <p><img src="../assets/img/2020-08-06-PR2_pic/image-20200806235125169.png" alt="image-20200806235125169" style="zoom:67%;" /></p>
  </li>
  <li>
    <p>展示 pace network 的效果</p>

    <p><img src="../assets/img/2020-08-06-PR2_pic/image-20200807001138289.png" alt="image-20200807001138289" style="zoom:67%;" /></p>

    <p>黑线：轨迹曲率，作为输入，尖锐部分表示有大的转向</p>

    <p>蓝、绿线：可以看到在转弯处，速度明显减慢、步频略微加快，合理</p>

    <p>橙线：面部朝向变换合理</p>
  </li>
</ul>


<span class="post-date">
  Written on
  
  August
  6th,
  2020
  by
  
    mettyz
  
</span>

<!-- <div class="post-date">Feel free to share!</div>
  <div class="sharing-icons">
    <a href="https://twitter.com/intent/tweet?text=Paper Reading Record 2&amp;url=/PR2.html" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=/PR2.html&amp;title=Paper Reading Record 2" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
    <a href="https://plus.google.com/share?url=/PR2.html" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
  </div>
</div>
 -->

<!--<div class="related">
  <h1 >You may also enjoy:</h1>
  
  <ul class="related-posts">
    
  </ul>
</div>
 -->



    </div>

    <footer class="footer">
  
  
  
    <a href="https://www.github.com/mettyz" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:1243049625@qq.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

  
  
    <a href="/feed.xml"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  

  <div class="post-date"><a href="/menu/about.html">MettyZ's Blog | Seize the day</a></div>
</footer>

  </div>

</body>
</html>
