<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2020-08-07T00:52:11+08:00</updated><id>/feed.xml</id><title type="html">MettyZ’s Blog</title><subtitle></subtitle><author><name>mettyz</name></author><entry><title type="html">Paper Reading Record 2</title><link href="/PR2.html" rel="alternate" type="text/html" title="Paper Reading Record 2" /><published>2020-08-06T00:00:00+08:00</published><updated>2020-08-06T00:00:00+08:00</updated><id>/PR2</id><content type="html" xml:base="/PR2.html">&lt;p&gt;QuaterNet: A Quaternion-based Recurrent Model for Human Motion &lt;a href=&quot;https://arxiv.org/pdf/1805.06485.pdf&quot;&gt;[Paper]&lt;/a&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;blockquote&gt;
  &lt;p&gt;写在前面：文中包含个人理解，不保证正确，如理解有误，欢迎指正。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;main-idea&quot;&gt;Main Idea&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;基于&lt;strong&gt;四元数&lt;/strong&gt;构建模型，在描述3D运动上有天然优势&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;损失函数&lt;strong&gt;采用关节点位置误差&lt;/strong&gt;（将 预测旋转 与 预测绝对位置 两类方法的优势相结合）&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;为短期预测与长期预测分别构建了模型&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;对长期预测，加入了人工特征控制（轨迹、速度、面部朝向、步频）&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;残差连接&lt;/strong&gt;在短期预测中有优势，在长期预测中不适用&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;人类行为是一个具有&lt;strong&gt;高度内在不确定性&lt;/strong&gt;的随机序列过程，这为长期预测带来挑战&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;短期预测&lt;/strong&gt;通常被看作&lt;em&gt;预测&lt;/em&gt; 任务 (short-term prediction)&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;能够通过将预测结果与参考结果对比来定量计算损失&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;长期预测&lt;/strong&gt;通常被看作&lt;em&gt;生成&lt;/em&gt; 任务 (long-term generation)&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;定量评估较为困难，可以让人来评估生成质量&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;related-work&quot;&gt;Related Work&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;行为预测的两大类方式 —— &lt;em&gt;Joint Rotations&lt;/em&gt; v.s. &lt;em&gt;Joint Positions&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;&lt;strong&gt;预测关节点的旋转 (Joint Rotations)&lt;/strong&gt;&lt;/p&gt;

        &lt;p&gt;优势：自然地以骨架作为约束，避免了躯干伸缩及超出关节范围的运动等问题&lt;/p&gt;

        &lt;p&gt;缺陷：&lt;/p&gt;

        &lt;ul&gt;
          &lt;li&gt;
            &lt;p&gt;通常计算各关节点的平均损失，即不同关节点的权重相同&lt;/p&gt;

            &lt;blockquote&gt;
              &lt;p&gt;实际上，不同关节点的错位对姿态的影响程度不同，如连接躯干及四肢的关节点对姿态的影响强于四肢末端的关节点&lt;/p&gt;
            &lt;/blockquote&gt;

            &lt;p&gt;这可能导致模型的预测结果在重要关节上出现较大误差，影响视觉效果&lt;/p&gt;

            &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;&lt;strong&gt;预测关节点的位置 (Joint Positions)&lt;/strong&gt;&lt;/p&gt;

        &lt;p&gt;优势：极小化绝对位置损失，避免了上述缺陷&lt;/p&gt;

        &lt;p&gt;缺陷：缺乏骨架约束，四肢躯干可能出现变形，需要将预测结果作重映射调整，增加训练难度，带来额外开销，且重映射可能导致动作的不连续&lt;/p&gt;

        &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;利用残差连接帮助训练&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;直观上理解，残差连接迫使网络预测变化的 “速度 (velocities) “ 而不是 “值 (absolute values)”&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;../assets/img/2020-08-06-PR2_pic/image-20200806175039090.png&quot; alt=&quot;image-20200806175039090&quot; style=&quot;zoom: 67%;&quot; /&gt;&lt;/p&gt;

        &lt;blockquote&gt;
          &lt;p&gt;[1] Julieta Martinez, Michael J. Black, and Javier Romero. On human motion prediction using recurrent neural networks. In Conference on Vision and Pattern Recognition (CVPR), 2017.&lt;/p&gt;
        &lt;/blockquote&gt;

        &lt;ul&gt;
          &lt;li&gt;
            &lt;p&gt;优势：使得需要预测的值被限制在较小的范围内，有助于网络收敛&lt;/p&gt;

            &lt;p&gt;缺陷：在长期预测任务上表现不稳定，由于误差累积可能导致糟糕结果&lt;/p&gt;

            &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;&lt;strong&gt;建模方法&lt;/strong&gt;&lt;/p&gt;

        &lt;ul&gt;
          &lt;li&gt;
            &lt;p&gt;早期方法：每步输入ground truth motion作为教师监督&lt;/p&gt;

            &lt;p&gt;缺陷：模型不具备错误恢复能力&lt;/p&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;[1] 方法：每步输入上一步的预测结果&lt;/p&gt;

            &lt;p&gt;缺陷：如果用于长期预测，累积损失将会很大，导致模型将难以训练&lt;/p&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;任务分解法：将长期预测任务分解为 1) 定义运动轨迹 2) 用 footsteps 标注轨迹 3) 生成姿态序列&lt;/p&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;生成模型&lt;/p&gt;

            &lt;blockquote&gt;
              &lt;p&gt;Jacob Walker, Kenneth Marino, Abhinav Gupta, and Martial Hebert. The pose knows: Video forecasting by generating pose futures. International Conference on Computer Vision (ICCV), 2017. 【待阅读】&lt;/p&gt;
            &lt;/blockquote&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;method&quot;&gt;Method&lt;/h2&gt;

&lt;h3 id=&quot;architecture&quot;&gt;Architecture&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;../assets/img/2020-08-06-PR2_pic/image-20200806193719030.png&quot; alt=&quot;image-20200806193719030&quot; style=&quot;zoom:80%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;构建使用双层GRU的自回归模型&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;与 [1] 不同，团队发现增加第二层GRU具有经验优势，但不必增加到三层【可以验证一下】，设置 hidden size = 1000&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Short-term Prediction：每步输入上一步的预测结果&lt;/p&gt;

    &lt;p&gt;Long-term Generation：每步以概率 p 输入 ground truth 监督&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;随着训练过程的进行，p 从1开始递减： $p_{t+1} = \beta p_t$，其中 $\beta =0.995$&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Rotations：由单位四元数描述的关节旋转状态&lt;/p&gt;

    &lt;p&gt;Translations：用于建模高频运动细节，使生成的动画更加逼真&lt;/p&gt;

    &lt;p&gt;Controls：轨迹控制信息&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;Translations 和 Controls 的数学细节没太看懂&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;对短期预测采用了QMul，即训练模型预测从当前姿态到下一姿态的变换角度&lt;/p&gt;

    &lt;p&gt;对长期预测未采用QMul，即训练模型预测准确的下一姿态&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;如下图实验显示，残差连接用于长期预测将累积误差，导致模型不稳定，&lt;/p&gt;

      &lt;p&gt;而不采用残差的方法在长期预测中表现出优势&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;img src=&quot;../assets/img/2020-08-06-PR2_pic/image-20200806234435170.png&quot; alt=&quot;image-20200806234435170&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;rotation-parameterization&quot;&gt;Rotation Parameterization&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;欧拉角，指数映射&lt;/strong&gt;  $ R^3$&lt;/p&gt;

    &lt;p&gt;缺陷：表示不唯一 ($\alpha=\alpha+2\pi n$)、表示空间不连续、奇点 (gimbal loack 万向锁)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;四元数&lt;/strong&gt;  $ R^4 $&lt;/p&gt;

    &lt;p&gt;优势：不存在上述三维空间中的问题，且数值更加稳定、计算更加高效&lt;/p&gt;

    &lt;p&gt;缺陷：需要保证单位长度，因此每步都需要进行正则化&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;对 $q=w+xi+yj+zk$，要求 $||q||=\sqrt{w^2+x^2+y^2+z^2}=1$&lt;/p&gt;

      &lt;p&gt;本文为损失函数添加了正则约束 $\lambda(w^2+x^2+y^2+z^2-1)$ ，设置 $\lambda=0.01$&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;forward-kinematics-loss&quot;&gt;Forward Kinematics Loss&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;直接对角度进行回归可能会导致关键关节点出现偏差，进而显著影响整体姿态效果&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;本文的损失函数根据预测出的四元数计算出关节点的预测位置，再计算欧几里得距离作为损失&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;&lt;strong&gt;Forward kinematics&lt;/strong&gt; refers to the use of the kinematic equations of a robot to compute the position of the end-effector from specified values for the joint parameters. &lt;a href=&quot;https://en.wikipedia.org/wiki/Forward_kinematics&quot;&gt;Wiki&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;long-term-generation&quot;&gt;Long-Term Generation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;任务定义：给定平均速度与运动轨迹，生成姿态序列&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;任务分解&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;1）沿着轨迹定义参数：角色面对的方向，局部速度，脚步频率&lt;/p&gt;

        &lt;blockquote&gt;
          &lt;p&gt;&lt;strong&gt;轨迹表示&lt;/strong&gt;&lt;/p&gt;

          &lt;p&gt;可视为分段线性样条 piecewise linear spline，可理解为分段线性函数&lt;/p&gt;

          &lt;p&gt;在本任务背景下，轨迹可以按等长时间分段，相当于在每小段时间内面向某个方向，以某个速度前进&lt;/p&gt;
        &lt;/blockquote&gt;

        &lt;blockquote&gt;
          &lt;p&gt;&lt;strong&gt;pace network&lt;/strong&gt;&lt;/p&gt;

          &lt;p&gt;参数可以人工设置，也可以通过训练速度网络(pace network)自动生成&lt;/p&gt;

          &lt;p&gt;采用单层GRU, hidden size = 30，输入轨迹曲线与上一步的隐状态，预测上述参数&lt;/p&gt;

          &lt;p&gt;可以根据 在线/离线场景 设置 单向/双向GRU&lt;/p&gt;
        &lt;/blockquote&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;2）预测姿态序列 (pose network，如架构图所示)&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;experiments&quot;&gt;Experiments&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;下述只提及文中部分实验结果&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;证实残差连接在短期预测中的优势&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;../assets/img/2020-08-06-PR2_pic/image-20200806235125169.png&quot; alt=&quot;image-20200806235125169&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;展示 pace network 的效果&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;../assets/img/2020-08-06-PR2_pic/image-20200807001138289.png&quot; alt=&quot;image-20200807001138289&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;黑线：轨迹曲率，作为输入，尖锐部分表示有大的转向&lt;/p&gt;

    &lt;p&gt;蓝、绿线：可以看到在转弯处，速度明显减慢、步频略微加快，合理&lt;/p&gt;

    &lt;p&gt;橙线：面部朝向变换合理&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name>mettyz</name></author><summary type="html">Human Motion Prediction, 3D-skeleton, Quaternion, RNN...</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/PR2.png" /><media:content medium="image" url="/PR2.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Paper Reading Record 1</title><link href="/PR1.html" rel="alternate" type="text/html" title="Paper Reading Record 1" /><published>2020-07-18T00:00:00+08:00</published><updated>2020-07-18T00:00:00+08:00</updated><id>/PR1</id><content type="html" xml:base="/PR1.html">&lt;p&gt;(CVPR2020) &lt;a href=&quot;https://openaccess.thecvf.com/content_CVPR_2020/papers/Yu_Weakly_Supervised_Discriminative_Feature_Learning_With_State_Information_for_Person_CVPR_2020_paper.pdf&quot;&gt;[Paper]&lt;/a&gt;&lt;/p&gt;

&lt;!--more--&gt;

&lt;blockquote&gt;
  &lt;p&gt;写在前面：文中包含个人理解，不保证正确，如理解有误，欢迎指正。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;main-idea&quot;&gt;Main Idea&lt;/h2&gt;

&lt;p&gt;利用状态信息作为弱监督信号，来学习能够区分人身份的特征&lt;/p&gt;

&lt;p&gt;旨在处理由不同状态带来的视觉差异对模型的影响&lt;/p&gt;

&lt;p&gt;利用WFDR将较强烈的特征畸变变得温和，利用WDBR矫正较温和的特征畸变&lt;/p&gt;

&lt;h2 id=&quot;keywords&quot;&gt;Keywords&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;State Information：e.g. camera views, poses&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;论文中所利用的状态信息，是指那些&lt;strong&gt;无需额外人工标记&lt;/strong&gt;的，在数据集收集过程中就自带的状态标签，如拍摄的机位编号，拍摄的角度等&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;WDBR: Weakly supervised decision boundary rectification 【弱监督的决策边界矫正】&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;WFDR: Weakly supervised feature drift regularization 【弱监督的特征偏移正则化】&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;MPI: Maximum Predominance Index 【最大优势指数】&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;visual discrepancy，feature distortion&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;pseudo class = surrogate class&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;methods&quot;&gt;Methods&lt;/h2&gt;

&lt;h3 id=&quot;pseudo-label-model&quot;&gt;Pseudo label model&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;指论文采用的&lt;strong&gt;训练策略&lt;/strong&gt;，采用了聚类的思想&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;基本思路&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;初始设置 $K$ 个伪类，$K&amp;gt;$ 最大类别数，极端假设下，可以假设每张图像属于一个伪类&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;例：对于RE-ID，最大类别数即为数据集中不同人的数目，伪类的含义为身份id&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;通过WDBR调整边界，有些伪类可能收缩到一个点，相当于被作废&lt;/p&gt;

    &lt;p&gt;通过极小化分类损失训练模型，直观意义上，就是让样本尽可能靠近它被分到的伪类中心&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;拉近类内距离，拉远类间距离，提升特征空间的模块化程度&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200719112833305.png&quot; alt=&quot;image-20200719112833305&quot; style=&quot;zoom: 80%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;训练目标&lt;/strong&gt;：特征提取器 $f$ ，用于提取可以区分身份的特征&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;利用模型将图像映射到状态空间中，同一身份的样本应该相互靠近&lt;/p&gt;

      &lt;p&gt;进一步可利用聚类算法分类&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;符号说明&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;$u_i$ ：一个无标签的图像样本，训练集中共有 $N$ 个样本&lt;/p&gt;

    &lt;p&gt;$x$ ：特征空间中的向量表示&lt;/p&gt;

    &lt;p&gt;$\theta$：模型 $f$ 的参数&lt;/p&gt;

    &lt;p&gt;$s_i\in{1,\dots,J}$ ：样本 $i$ 的状态信息取值，有 $J$  种&lt;/p&gt;

    &lt;p&gt;$\mu$ ：伪类分类器，即聚类中心&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;$x^T\mu_j$ 衡量了特征向量 $x$ 与聚类中心 $\mu_j$ 的相似程度，可看作将 $x$ 分到伪类 $j$ 的得分&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;wdbr&quot;&gt;WDBR&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;在&lt;strong&gt;较温和&lt;/strong&gt;的视觉差异的影响下，特征空间中，无标签样本可能稍微偏离正确的区域，到附近区域中&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;解决思路：通过调整决策边界，使无标签样本能够落在正确区域内&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/WDBR.png&quot; style=&quot;zoom: 50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;定义MPI&lt;/strong&gt; (最大优势指数)&lt;/p&gt;

    &lt;p&gt;用于量化一个伪类受某种状态支配的程度&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;MPI越大，说明这些样本之所以被归为这一类，很可能是因为受到了这个状态的影响，而这个状态本身不是我们期望模型用于分类的特征&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;

    &lt;p&gt;具体定义为&lt;strong&gt;伪类中具有支配状态的样本的占比&lt;/strong&gt;，形式化如下&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/MPI.png&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;其中，分母表示当前伪类k中样本个数，分子表示在某一状态上取值相同的最大子集&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;分子 = $max_j$ (伪类k中状态取值为 $j$ 的样本个数)&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;矫正策略&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;利用下述分类公式，可&lt;strong&gt;将 MPI 值超过阈值的伪类收缩&lt;/strong&gt;，甚至作废&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;$a$ 可视作&lt;strong&gt;矫正力度&lt;/strong&gt;，$b$ 可视作&lt;strong&gt;矫正阈值&lt;/strong&gt;&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;可以看到，在hard设定下，超过阈值的伪类 $p(k)=0$，此时不会有样本被分到该类，即实现了将该类作废&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200717084810814.png&quot; style=&quot;zoom: 67%;&quot; /&gt; &lt;img src=&quot;/assets/img/PR1_pic/image-20200717085548489.png&quot; style=&quot;zoom: 45%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;小结&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;WDBR 训练模型倾向于扩大 MPI 值较小的伪类的作用域&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;MPI 值较小，意味着这个伪类当中的样本在各个状态上的分布较为均衡，也就意味着它们被分在一起不是因为受到这些状态信息的影响&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;如此训练出的模型将倾向于提取对状态信息不敏感的特征&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;wfdr&quot;&gt;WFDR&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;当视觉差异影响&lt;strong&gt;较严重&lt;/strong&gt;时，样本可能会严重偏离正确区域&lt;/p&gt;

    &lt;p&gt;此时，若想使用WDBR，需要先将特征畸变变得温和 (significant $\to$ moderate)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;解决思路&lt;/p&gt;

    &lt;p&gt;受某种状态影响导致的特征畸变通常遵循一个特定的模式（如照明不足将抑制所有视觉特征），这会导致特征空间中，处于该状态的样本向同一个方向偏移&lt;/p&gt;

    &lt;p&gt;因此，我们可以在全局尺度上捕获这种偏移，然后把它“拉回来”&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/WFDR.png&quot; style=&quot;zoom: 50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;如何捕获？&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;捕捉状态子分布  ( state sub-distribution ) 与全局样本特征分布之间的偏差&lt;/p&gt;

    &lt;p&gt;假设 $P(Q_j)$  为状态取值为 $j$ 的样本的分布情况，$P(X)$ 为所有样本的分布情况，&lt;/p&gt;

    &lt;p&gt;畸变将导致 $P(Q_j)$ 偏离 $P(X)$&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;矫正策略&lt;/strong&gt;&lt;/p&gt;

    &lt;p&gt;拉近两分布的距离，对应损失函数如下：&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200717095414630.png&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200717095435308.png&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;小结&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;可以看出，损失函数对两个分布之间的距离进行惩罚，并调整参数 $\theta$&lt;/p&gt;

        &lt;blockquote&gt;
          &lt;p&gt;$\theta$ 是目标特征提取器的参数&lt;/p&gt;
        &lt;/blockquote&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;直观上，这将使模型在提取特征向量时，减少对状态的关注，即尽量不让这个状态影响到特征向量的分布&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;loss-function&quot;&gt;Loss Function&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200719113120576.png&quot; alt=&quot;image-20200719113120576&quot; style=&quot;zoom:80%;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&quot;experiments&quot;&gt;Experiments&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Tasks&lt;/strong&gt;：person re-identification (&lt;strong&gt;RE-ID&lt;/strong&gt;) and pose-invariant face recognition (&lt;strong&gt;PIFR&lt;/strong&gt;)&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;RE-ID：将不同镜头下拍摄到的人进行身份匹配，对应状态信息：相机标签&lt;/p&gt;

      &lt;p&gt;PIFR：将不同姿势的人脸进行匹配，对应状态信息：姿势（不同角度/正侧面）&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200719115228806.png&quot; style=&quot;zoom:67%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;消蚀实验等验证模型有效性与准确性的实验不再赘述，先说&lt;strong&gt;结论&lt;/strong&gt;：&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;动态调整聚类中心、WDBR、WFDR均有效&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;WDBR 与 WFDR 的能力能够互为补充&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;对样本不平衡的数据集，WDBR 的 hard 矫正可能更加有效，而对于平衡的数据集，soft 矫正能够体现出优势&lt;/p&gt;

        &lt;blockquote&gt;
          &lt;p&gt;平衡：数据集中每个人有多少张照片是固定的&lt;/p&gt;
        &lt;/blockquote&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;分析一些实验现象&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/PR1_pic/image-20200719115725587.png&quot; alt=&quot;image-20200719115725587&quot; style=&quot;zoom: 70%;&quot; /&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;&lt;strong&gt;在 Multi-PIE 中，WFDR没有起到很大作用&lt;/strong&gt;&lt;/p&gt;

        &lt;p&gt;可能原因：在 Multi-PIE 中，人脸角度变化是连续的，因此特征本就没有很大的偏移&lt;/p&gt;

        &lt;p&gt;&lt;br /&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;&lt;strong&gt;soft 矫正在 PIFR 任务上表现较好，而 hard 矫正在 RE-ID 任务上表现较好&lt;/strong&gt;&lt;/p&gt;

        &lt;p&gt;可能原因：RE-ID 数据集中，不同身份的人的图像数量不均衡&lt;/p&gt;

        &lt;p&gt;&lt;strong&gt;soft 矫正器&lt;/strong&gt; 的权重变化是一个连续的过程，它将更倾向于状态均衡程度高的伪类，因此机位照片多的人将更可能获得大权重，这是不公平的&lt;/p&gt;

        &lt;blockquote&gt;
          &lt;p&gt;如果一个人只有2个机位的照片，则他的 MPI 值至少是 1/2，而有6个机位照片的人，MPI 值最小是 1/6，因此能够获得更大的 $p(k)$&lt;/p&gt;
        &lt;/blockquote&gt;

        &lt;p&gt;&lt;strong&gt;hard 矫正器&lt;/strong&gt; 是一个阶跃函数，仅仅使具有很高 MPI 值的伪类失效，对状态均衡的&lt;strong&gt;程度&lt;/strong&gt;没有偏好&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;my-thoughts&quot;&gt;My Thoughts&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;状态信息的寻找与利用依靠人工设计，有没有可能让网络自己衡量特征对任务的帮助程度？&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;在浅层网络中，特征向量的每一个维度可能对应着某一种状态属性&lt;/p&gt;

      &lt;p&gt;随着网络的加深，每个维度则可能编码着多种状态的综合属性&lt;/p&gt;

      &lt;p&gt;如果修改一个特征，能够让一组样本发生整体的偏移，而样本之间的相对距离变化不大，是否能够说明这个特征是某种对区分样本帮助不大的状态特征？&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;训练集中的人和测试集中的人没有重合&lt;/strong&gt;&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;很关键，这样一来能够测试出模型学习到的特征是否是关注于”区分”，而非提取这个人本身的特征&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ol&gt;</content><author><name>mettyz</name></author><summary type="html">CVPR2020, Weakly supervised, State information...</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="/PR1.png" /><media:content medium="image" url="/PR1.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>